---
title: 'Lecture notes: A few comments on color scales'
author: Drew
date: '2019-09-16'
slug: lecture-notes-a-few-comments-on-color-scales
categories: []
tags: []
---

# Types of color scales for types of data

* Qualitative color scales: Data in **unordered** categories
  * e.g. regions of the country (Northeast, Midwest, South)
* Sequential color scales: Data in an **ordered** variable 
  * e.g. income (continuous numeric variable ranging from $0 to some high number)
* Diverging color scales: Data in that **diverge** from some **neutral** midpoint
  * e.g. relative values of a continuous numeric variable compared to a mean, where negative values indicate lower than average and positive values indicate higher than average. Temperature anomolies are a common example in geoscience.
  * Note that I don't think Fig 4-6 in Wilke is a great example. Here, "percent of population of counties identifying as white" is mapped to a diverging color scale, with 50% as 'neutral'. But 50% white people probably isn't 'neutral' in any sense.
  * A better example of the diverging scale is if Willke had calcualted the average fraction of the population of the whole state that identifies as white, and represented whether each county had higher or lower fraction compared to the state average.
  
```{r, message = FALSE, warning=FALSE}
library(dviz.supp)

theme_set(theme_minimal())

popgrowth_df <- left_join(US_census, US_regions) %>%
    group_by(region, division, state) %>%
    summarize(pop2000 = sum(pop2000, na.rm = TRUE),
              pop2010 = sum(pop2010, na.rm = TRUE),
              popgrowth = (pop2010-pop2000)/pop2000,
              area = sum(area)) %>%
    arrange(popgrowth) %>%
    ungroup() %>%
    mutate(state = factor(state, levels = state),
           region = factor(region, levels = c("West", "South", "Midwest", "Northeast")))

# make color vector in order of the state
region_colors <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442")
region_colors_dark <- darken(region_colors, 0.4)
state_colors <- region_colors_dark[as.numeric(popgrowth_df$region[order(popgrowth_df$state)])]

p_region_growth <- ggplot(popgrowth_df, aes(x = state, y = 100*popgrowth, fill = region)) + 
  geom_col() + 
  scale_y_continuous(
    limits = c(-.6, 37.5), expand = c(0, 0),
    labels = scales::percent_format(accuracy = 1, scale = 1),
    name = "population growth, 2000 to 2010"
  ) +
  scale_fill_manual(values = region_colors) +
  coord_flip() + 
  #theme_dviz_vgrid(12, rel_small = 1) +
  theme(axis.title.y = element_blank(),
        axis.line.y = element_blank(),
        axis.ticks.length = unit(0, "pt"),
        axis.text.y = element_text(size = 10, color = state_colors),
        legend.position = c(.56, .68),
        #legend.text = element_text(color = region_colors),
        legend.background = element_rect(fill = "#ffffffb0"))
print(p_region_growth)
```

[Colorbrewer2](https://colorbrewer2.org) is a great resource for good color schemes. Using the `scale_color_brewer()` and `scale_fill_brewer()` functions, you can get automatically-assigned color schemes. Alternately, you can specify the `type` (sequential, diverging, or qualitative), or the specific palette (I find Dark2 is pretty great for qualitative plots in print). 

```{r, message = FALSE}
# Use colorbrewer2 to get a qualitative scale
p_region_growth +
  scale_fill_brewer(type = "qual")

p_region_growth +
  scale_fill_brewer(palette = "Dark2")
```

Note that there are, like, a billion color palette generators on the internet, and quite a few of these are available as an R package (see, for instance, the Wes Anderson color palette generator](https://github.com/karthik/wesanderson)). If **colorbrewer2** isn't giving you colors you like, just ask your friend Google for help.

# Colorblindness

About 1% of men, and 8% of men of northwestern-European descent, are [red-green colorblind](https://en.wikipedia.org/wiki/Color_blindness#Deuteranopia). Thus, it is likely that some substantial fraction of your audience won't be able to make sense of a plot if it isn't colorblind-friendly. There are three good ways to identify colorblind-safe palettes.

* Be colorblind yourself, or have a friend who is. Run your plots by them. (I'm being a little facetious here, but I'd much rather get a personal opinion rather than rely on a simulator. Of course, to be complete, you'd need one friend with each different kind of colorblindness).
* Use the colorblind-safe palettes generated by **colorbrewer2**.
* Use a colorblindness simulator, like the R package **colorblindr**, or one of the many simulator websites, e.g. [Colblindor](https://www.color-blindness.com/coblis-color-blindness-simulator/)


# Limits of color scales

Color scales are easy to misuse. See Wilke, [Chapter 19](https://serialmentor.com/dataviz/color-pitfalls.html) on this. Briefly:

* You can't generally distinguish more than ~8 colors, so a qualitative scheme with more than 8 or colors will be difficult to interpret.
* Many common 'rainbow' color maps create perceptually non-monotonic color schemes. The [Jet scale](https://blogs.mathworks.com/headlines/2018/10/10/a-dangerous-rainbow-why-colormaps-matter/) is a particularly serious offender in this regard, and is very frequently used. A much better alternative is the [viridis](https://cran.r-project.org/web/packages/viridis/index.html) scale (note that package also has a bunch of different, perceptually-uniform scales). Google has also recently [released](https://ai.googleblog.com/2019/08/turbo-improved-rainbow-colormap-for.html) a scale that looks promising.
